<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: white;
            font-family: Arial, sans-serif;
        }
        .chart-container {
            position: relative;
            width: 95vw;
            height: 90vh;
        }
    </style>
</head>
<body>
    <div class="chart-container">
        <canvas id="myChart"></canvas>
    </div>
    <script>
        async function createChart() {
            try {

                let dict = {}
                dict['1'] = 'TAR@FAR 0.01%'
                dict['2'] = 'Rank-1 Acc'
                dict['3'] = 'Rank-5 Acc'
                dict['4'] = 'Average Latency (ms)'
                dict['5'] = 'Throughput (FPS)'
                dict['6'] = 'Estimated Total Size(MB)'
                dict['7'] = 'GFLOPs'
                dict['8'] = 'Mparams'
                dict['9'] = 'EER'

                const flag = dict['1']; // 'TAR@FAR 0.01%', 'Rank-1 Acc', 'Rank-5 Acc', 'Average Latency (ms)', 'Throughput (FPS)', 'Estimated Total Size(MB)'
                
                const jsonData = [
                    {
                        "모델명": "TransFace vit_l (Glint360K)",
                        "Backbone": "VIT · Glint360K",
                        "ROC-AUC": 0.9995,
                        "EER": 0.0088,
                        "Accuracy": 0.9912,
                        "TAR@FAR 0.01%": 0.8843,
                        "Rank-1 Acc": 0.9853,
                        "Rank-5 Acc": 0.9989,
                        "Average Latency (ms)": 16.93,
                        "Throughput (FPS)": 59.05,
                        "Estimated Total Size(MB)": 1226.04,
                        "GFLOPs": 24.621,
                        "Mparams": 271.630,
                        "TAR@FAR 1%": 0.9921,
                        "TAR@FAR 0.1%": 0.9615
                    },
                    {
                        "모델명": "TransFace vit_s (Glint360K)",
                        "Backbone": "VIT · Glint360K",
                        "ROC-AUC": 0.9980,
                        "EER": 0.0196,
                        "Accuracy": 0.9804,
                        "TAR@FAR 0.01%": 0.7531,
                        "Rank-1 Acc": 0.9642,
                        "Rank-5 Acc": 0.9928,
                        "Average Latency (ms)": 8.48,
                        "Throughput (FPS)": 117.92,
                        "Estimated Total Size(MB)": 393.70,
                        "GFLOPs": 5.513,
                        "Mparams": 86.661,
                        "TAR@FAR 1%": 0.9676,
                        "TAR@FAR 0.1%": 0.8897
                    },
                    {
                        "모델명": "TopoFR R200 (Glint360k)",
                        "Backbone": "ResNet-200 · Glint360K",
                        "ROC-AUC": 0.9999,
                        "EER": 0.0037,
                        "Accuracy": 0.9963,
                        "TAR@FAR 0.01%": 0.9539,
                        "Rank-1 Acc": 0.9895,
                        "Rank-5 Acc": 0.9997,
                        "Average Latency (ms)": 45.74,
                        "Throughput (FPS)": 21.86,
                        "Estimated Total Size(MB)": 672.28,
                        "GFLOPs": 23.485,
                        "Mparams": 119.096,
                        "TAR@FAR 1%": 0.9985,
                        "TAR@FAR 0.1%": 0.9897
                    },
                    {
                        "모델명": "TopoFR R200 (ms1mv2)",
                        "Backbone": "ResNet-200 · MS1MV2",
                        "ROC-AUC": 0.9996,
                        "EER": 0.0083,
                        "Accuracy": 0.9916,
                        "TAR@FAR 0.01%": 0.8919,
                        "Rank-1 Acc": 0.9823,
                        "Rank-5 Acc": 0.9986,
                        "Average Latency (ms)": 35.55,
                        "Throughput (FPS)": 28.13,
                        "Estimated Total Size(MB)": 672.28,
                        "GFLOPs": 23.485,
                        "Mparams": 119.096,
                        "TAR@FAR 1%": 0.9929,
                        "TAR@FAR 0.1%": 0.9634
                    },
                    {
                        "모델명": "TopoFR R100 (Glint360k)",
                        "Backbone": "ResNet-100 · Glint360K",
                        "ROC-AUC": 0.9998,
                        "EER": 0.0058,
                        "Accuracy": 0.9942,
                        "TAR@FAR 0.01%": 0.9234,
                        "Rank-1 Acc": 0.9879,
                        "Rank-5 Acc": 0.9994,
                        "Average Latency (ms)": 24.62,
                        "Throughput (FPS)": 40.62,
                        "Estimated Total Size(MB)": 373.88,
                        "GFLOPs": 12.128,
                        "Mparams": 65.418,
                        "TAR@FAR 1%": 0.9966,
                        "TAR@FAR 0.1%": 0.9777
                    },
                    {
                        "모델명": "AdaFace ir101 (webface12m)",
                        "Backbone": "IR-101 · WebFace12M",
                        "ROC-AUC": 0.9999,
                        "EER": 0.0030,
                        "Accuracy": 0.9970,
                        "TAR@FAR 0.01%": 0.9608,
                        "Rank-1 Acc": 0.9919,
                        "Rank-5 Acc": 1.0000,
                        "Average Latency (ms)": 13.57,
                        "Throughput (FPS)": 73.67,
                        "Estimated Total Size(MB)": 483.74,
                        "GFLOPs": 12.122,
                        "Mparams": 65.151,
                        "TAR@FAR 1%": 0.9992,
                        "TAR@FAR 0.1%": 0.9921
                    },
                    {
                        "모델명": "AdaFace ir101 (webface4m)",
                        "Backbone": "IR-101 · WebFace4M",
                        "ROC-AUC": 0.9998,
                        "EER": 0.0052,
                        "Accuracy": 0.9948,
                        "TAR@FAR 0.01%": 0.9264,
                        "Rank-1 Acc": 0.9906,
                        "Rank-5 Acc": 0.9999,
                        "Average Latency (ms)": 13.57,
                        "Throughput (FPS)": 73.67,
                        "Estimated Total Size(MB)": 483.74,
                        "GFLOPs": 12.122,
                        "Mparams": 65.151,
                        "TAR@FAR 1%": 0.9973,
                        "TAR@FAR 0.1%": 0.9814
                    },
                    {
                        "모델명": "AdaFace ir101 (MS1MV3)",
                        "Backbone": "IR-101 · MS1MV3",
                        "ROC-AUC": 0.9995,
                        "EER": 0.0093,
                        "Accuracy": 0.9907,
                        "TAR@FAR 0.01%": 0.8801,
                        "Rank-1 Acc": 0.9863,
                        "Rank-5 Acc": 0.9991,
                        "Average Latency (ms)": 13.57,
                        "Throughput (FPS)": 73.67,
                        "Estimated Total Size(MB)": 483.74,
                        "GFLOPs": 12.122,
                        "Mparams": 65.151,
                        "TAR@FAR 1%": 0.9913,
                        "TAR@FAR 0.1%": 0.9591
                    },
                    {
                        "모델명": "AdaFace resnet50 (casia) ",
                        "Backbone": "ResNet-50 · Casia",
                        "ROC-AUC": 0.9873,
                        "EER": 0.0578,
                        "Accuracy": 0.9422,
                        "TAR@FAR 0.01%": 0.5035,
                        "Rank-1 Acc": 0.8918,
                        "Rank-5 Acc": 0.9653,
                        "Average Latency (ms)": 6.93,
                        "Throughput (FPS)": 144.28,
                        "Estimated Total Size(MB)": 315.59,
                        "GFLOPs": 6.325,
                        "Mparams": 43.586,
                        "TAR@FAR 1%": 0.8375,
                        "TAR@FAR 0.1%": 0.6738
                    },
                    
                    {
                        "모델명": "ArcFace resnet100 (ms1mv2)",
                        "Backbone": "ResNet-100 · MS1M",
                        "ROC-AUC": 0.9988,
                        "EER": 0.0148,
                        "Accuracy": 0.9852,
                        "TAR@FAR 0.01%": 0.8181,
                        "Rank-1 Acc": 0.9764,
                        "Rank-5 Acc": 0.9964,
                        "Average Latency (ms)": 11.46,
                        "Throughput (FPS)": 87.26,
                        "Estimated Total Size(MB)": 486.98,
                        "GFLOPs": 12.128,
                        "Mparams": 65.156,
                        "TAR@FAR 1%": 0.9795,
                        "TAR@FAR 0.1%": 0.9216
                    },
                    {
                        "모델명": "ArcFace irsnet50 (casia)",
                        "Backbone": "ResNet-50 · MS1M",
                        "ROC-AUC": 0.9896,
                        "EER": 0.0489,
                        "Accuracy": 0.9511,
                        "TAR@FAR 0.01%": 0.4157,
                        "Rank-1 Acc": 0.9174,
                        "Rank-5 Acc": 0.9718,
                        "Average Latency (ms)": 5.45,
                        "Throughput (FPS)": 183.58,
                        "Estimated Total Size(MB)": 292.27,
                        "GFLOPs": 6.319,
                        "Mparams": 43.575,
                        "TAR@FAR 1%": 0.8524,
                        "TAR@FAR 0.1%": 0.6373
                    },
  
                ];
                
                // flag에 따른 데이터 매핑
                const dataMapping = {
                    'TAR@FAR 0.01%': {
                        data: jsonData.map(row => row["TAR@FAR 0.01%"]),
                        label: 'TAR @ FAR 0.01%',
                        title: 'TAR @ FAR 0.01% Comparison',
                        yAxisTitle: 'TAR @ FAR 0.01%',
                        unit: '%',
                        multiplier: 100,
                        maxValue: 1.0
                    },
                    'Rank-1 Acc': {
                        data: jsonData.map(row => row["Rank-1 Acc"]),
                        label: 'Rank-1 Accuracy',
                        title: 'Rank-1 Accuracy Comparison',
                        yAxisTitle: 'Rank-1 Accuracy',
                        unit: '%',
                        multiplier: 100,
                        maxValue: 1.0
                    },
                    'Rank-5 Acc': {
                        data: jsonData.map(row => row["Rank-5 Acc"]),
                        label: 'Rank-5 Accuracy',
                        title: 'Rank-5 Accuracy Comparison',
                        yAxisTitle: 'Rank-5 Accuracy',
                        unit: '%',
                        multiplier: 100,
                        maxValue: 1.0
                    },
                    'Average Latency (ms)': {
                        data: jsonData.map(row => row["Average Latency (ms)"]),
                        label: 'Average Latency',
                        title: 'Average Latency Comparison',
                        yAxisTitle: 'Latency (ms)',
                        unit: 'ms',
                        multiplier: 1,
                        maxValue: null
                    },
                    'Throughput (FPS)': {
                        data: jsonData.map(row => row["Throughput (FPS)"]),
                        label: 'Throughput',
                        title: 'Throughput Comparison',
                        yAxisTitle: 'Throughput (FPS)',
                        unit: ' FPS',
                        multiplier: 1,
                        maxValue: null
                    },
                    'Estimated Total Size(MB)': {
                        data: jsonData.map(row => row["Estimated Total Size(MB)"]),
                        label: 'Model Size',
                        title: 'Model Size Comparison',
                        yAxisTitle: 'Size (MB)',
                        unit: ' MB',
                        multiplier: 1,
                        maxValue: null
                    },
                    'GFLOPs': {
                        data: jsonData.map(row => row["GFLOPs"]),
                        label: 'GFLOPs',
                        title: 'GFLOPs Comparison',
                        yAxisTitle: 'GFLOPs',
                        unit: ' GFLOPs',
                        multiplier: 1,
                        maxValue: null
                    },
                    'Mparams': {
                        data: jsonData.map(row => row["Mparams"]),
                        label: 'Mparams',
                        title: 'Model Parameters Comparison',
                        yAxisTitle: 'Parameters (M)',
                        unit: ' M',
                        multiplier: 1,
                        maxValue: null
                    },
                    'EER': {
                        data: jsonData.map(row => row["EER"]),
                        label: 'EER (Equal Error Rate)',
                        title: 'EER (Equal Error Rate) Comparison',
                        yAxisTitle: 'EER',
                        unit: '%',
                        multiplier: 100,
                        maxValue: null
                    }
                };

                const currentConfig = dataMapping[flag];
                if (!currentConfig) {
                    throw new Error(`Invalid flag: ${flag}`);
                }

                const labels = jsonData.map(row => row["모델명"]);

                const config = {
                  "type": "bar",
                  "data": {
                    "labels": labels,
                    "datasets": [
                      {
                        "label": "TAR @ FAR 0.01%",
                        "data": jsonData.map(row => row["TAR@FAR 0.01%"]),
                        "backgroundColor": "rgba(255, 99, 132, 0.8)",
                        "borderColor": "rgba(255, 99, 132, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "Rank-1 Accuracy",
                        "data": jsonData.map(row => row["Rank-1 Acc"]),
                        "backgroundColor": "rgba(255, 159, 64, 0.8)",
                        "borderColor": "rgba(255, 159, 64, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "Rank-5 Accuracy",
                        "data": jsonData.map(row => row["Rank-5 Acc"]),
                        "backgroundColor": "rgba(255, 205, 86, 0.8)",
                        "borderColor": "rgba(255, 205, 86, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "Average Latency (Normalized)",
                        "data": jsonData.map(row => row["Average Latency (ms)"] / 100), 
                        "backgroundColor": "rgba(75, 192, 192, 0.8)",
                        "borderColor": "rgba(75, 192, 192, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "Throughput (Normalized)",
                        "data": jsonData.map(row => row["Throughput (FPS)"] / 200),
                        "backgroundColor": "rgba(54, 162, 235, 0.8)",
                        "borderColor": "rgba(54, 162, 235, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "Model Size (Normalized)",
                        "data": jsonData.map(row => row["Estimated Total Size(MB)"] / 1500), 
                        "backgroundColor": "rgba(153, 102, 255, 0.8)",
                        "borderColor": "rgba(153, 102, 255, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "GFLOPs (Normalized)",
                        "data": jsonData.map(row => row["GFLOPs"] / 30), 
                        "backgroundColor": "rgba(255, 193, 7, 0.8)",
                        "borderColor": "rgba(255, 193, 7, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "Mparams (Normalized)",
                        "data": jsonData.map(row => row["Mparams"] / 300), 
                        "backgroundColor": "rgba(156, 39, 176, 0.8)",
                        "borderColor": "rgba(156, 39, 176, 1)",
                        "borderWidth": 2
                      },
                      {
                        "label": "EER (Normalized)",
                        "data": jsonData.map(row => row["EER"] / 0.1), 
                        "backgroundColor": "rgba(255, 255, 255, 0.8)",
                        "borderColor": "rgba(255, 255, 255, 1)",
                        "borderWidth": 2
                      }
                    ]
                  },
                  "options": {
                    "responsive": true,
                    "maintainAspectRatio": false,
                    "scales": {
                      "y": {
                        "beginAtZero": true,
                        "max": 1.0,
                        "title": {
                          "display": true,
                          "text": "Normalized Values (0-1)",
                          "color": "#ffffff"
                        },
                        "ticks": {
                          "color": "#ffffff",
                          "callback": function(value) {
                            return (value * 100).toFixed(0) + '%';
                          }
                        },
                        "grid": {
                          "color": "rgba(255, 255, 255, 0.2)"
                        }
                      },
                      "x": {
                        "title": {
                          "display": true,
                          "text": "Model",
                          "color": "#ffffff"
                        },
                        "ticks": {
                          "color": "#ffffff",
                          "maxRotation": 0,
                          "minRotation": 0,
                          "font": {
                            "size": 14, // x축 모델 이름 라벨 크기
                            "color": "#ffffff"
                          }
                        },
                        "grid": {
                          "color": "rgba(255, 255, 255, 0.2)"
                        }
                      }
                    },
                    "plugins": {
                      "legend": {
                        "labels": {
                          "color": "#ffffff",
                          "font": {
                            "color": "#ffffff"
                          },
                          "generateLabels": function(chart) {
                            const original = Chart.defaults.plugins.legend.labels.generateLabels;
                            const labels = original.call(this, chart);
                            return labels;
                          }
                        }
                      },
                      "title": {
                        "display": true,
                        "text": "Model Performance Comparison (All Metrics)",
                        "color": "#ffffff",
                        "font": {
                            "size": 30
                        }
                      },
                      "tooltip": {
                        "callbacks": {
                          "label": function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                              label += ': ';
                            }
                            
                            const datasetIndex = context.datasetIndex;
                            const dataIndex = context.dataIndex;
                            let originalValue;
                            
                            if (datasetIndex === 0) { // TAR@FAR 0.01%
                              originalValue = (context.parsed.y * 100).toFixed(1) + '%';
                            } else if (datasetIndex === 1 || datasetIndex === 2) { // Rank-1, Rank-5 Acc
                              originalValue = (context.parsed.y * 100).toFixed(1) + '%';
                            } else if (datasetIndex === 3) { // Average Latency
                              originalValue = (context.parsed.y * 100).toFixed(1) + 'ms';
                            } else if (datasetIndex === 4) { // Throughput
                              originalValue = (context.parsed.y * 200).toFixed(1) + ' FPS';
                            } else if (datasetIndex === 5) { // Model Size
                              originalValue = (context.parsed.y * 1500).toFixed(0) + ' MB';
                            } else if (datasetIndex === 6) { // GFLOPs
                              originalValue = (context.parsed.y * 30).toFixed(2) + ' GFLOPs';
                            } else if (datasetIndex === 7) { // Mparams
                              originalValue = (context.parsed.y * 300).toFixed(1) + ' M';
                            } else if (datasetIndex === 8) { // EER
                              originalValue = (context.parsed.y * 0.1 * 100).toFixed(2) + '%';
                            }
                            
                            label += originalValue;
                            return label;
                          }
                        }
                      }
                    }
                  }
                };

                const ctx = document.getElementById('myChart').getContext('2d');
                new Chart(ctx, config);
                
            } catch (error) {
                console.error('Error creating chart:', error);
                const chartContainer = document.querySelector('.chart-container');
                chartContainer.innerHTML = `<p style="color: red; text-align: center;">Error loading chart data: ${error.message}</p>`;
            }
        }

        createChart();
    </script>
</body>
</html>